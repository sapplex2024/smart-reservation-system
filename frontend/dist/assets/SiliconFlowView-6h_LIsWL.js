import{u as ie,r as C,d as de,P as J,o as ue,a as u,b as l,e as o,T as b,t as U,k as n,w as a,E as ce,Y as pe,l as me,Z as fe,n as _e,f as ve,h as V,z as c,m as _,q as ye,v as ge,j as we,$ as R,F as E,B as S,S as he,A as ke,L as be,a0 as Ve,H as Ce,I as Ie,i as xe,a1 as Pe,a2 as Ae,J as Ee,a3 as Se,M as Te,a4 as Me,O as d,_ as Ue}from"./index-C-Q3ynzh.js";function je(){const j=ie(),m=()=>({Authorization:`Bearer ${j.token}`,"Content-Type":"application/json"}),v=C([]),p=C({api_key:"",base_url:"https://api.siliconflow.cn/v1",default_model:"Qwen/Qwen2.5-72B-Instruct",max_tokens:"4096",temperature:"0.7",stream:"true"}),y=C(null),i=C(!1),g=C(null);return{models:v,config:p,usage:y,loading:i,testResult:g,fetchModels:async()=>{try{i.value=!0;const s=await fetch("/api/siliconflow/models",{headers:m()});if(s.ok)v.value=await s.json();else throw new Error("获取模型列表失败")}catch(s){throw console.error("获取模型列表失败:",s),s}finally{i.value=!1}},fetchConfig:async()=>{try{i.value=!0;const s=await fetch("/api/siliconflow/config",{headers:m()});if(s.ok)p.value=await s.json();else throw new Error("获取配置失败")}catch(s){throw console.error("获取配置失败:",s),s}finally{i.value=!1}},updateConfig:async s=>{try{i.value=!0;const r=await fetch("/api/siliconflow/config",{method:"POST",headers:{...m(),"Content-Type":"application/json"},body:JSON.stringify(s)});if(r.ok)return Object.assign(p.value,s),await r.json();{const P=await r.json();throw new Error(P.detail||"更新配置失败")}}catch(r){throw console.error("更新配置失败:",r),r}finally{i.value=!1}},testAPIConnection:async s=>{try{i.value=!0,g.value=null;const r=await fetch("/api/siliconflow/test",{method:"POST",headers:{...m(),"Content-Type":"application/json"},body:JSON.stringify(s)});if(r.ok)return g.value=await r.json(),g.value;{const P=await r.json();throw new Error(P.detail||"API测试失败")}}catch(r){throw console.error("API测试失败:",r),g.value={success:!1,error:r instanceof Error?r.message:"未知错误"},r}finally{i.value=!1}},fetchUsage:async()=>{try{i.value=!0;const s=await fetch("/api/siliconflow/usage",{headers:m()});if(s.ok)y.value=await s.json();else throw new Error("获取使用统计失败")}catch(s){throw console.error("获取使用统计失败:",s),s}finally{i.value=!1}},formatPrice:s=>`¥${s.toFixed(4)}/1K tokens`,formatLatency:s=>`${(s*1e3).toFixed(0)}ms`,getProviderColor:s=>({Alibaba:"orange",DeepSeek:"blue",Meta:"purple",Microsoft:"cyan",THUDM:"green"})[s]||"gray",getModelTypeIcon:s=>({chat:"chatbubble-outline",completion:"document-text-outline",embedding:"layers-outline"})[s]||"help-outline"}}const Oe={class:"silicon-flow-view"},Be={class:"container"},Fe={key:0,class:"stats-grid"},$e={class:"stat-content"},Le={class:"stat-value"},Ne={class:"stat-content"},ze={class:"stat-value"},De={class:"stat-content"},Qe={class:"stat-value"},qe={class:"stat-content"},Ke={class:"stat-value"},He={class:"action-buttons"},Je={key:0,class:"loading-container"},Re={key:1,class:"empty-state"},Ye={key:2,class:"models-grid"},Ze=["onClick"],Ge={class:"model-header"},We={class:"model-info"},Xe={class:"model-description"},et={class:"model-details"},tt={class:"detail-item"},lt={class:"value"},st={key:0,class:"detail-item"},ot={class:"value"},at={key:1,class:"detail-item"},nt={class:"value"},rt={class:"popular-models"},it={class:"model-name"},dt={class:"usage-bar"},ut={class:"usage-stats"},ct={key:0,class:"test-result",style:{"margin-top":"20px"}},pt={key:0},mt={class:"test-stats"},ft={key:0},_t={key:1},vt={class:"response-content",style:{"margin-top":"10px"}},yt={key:1,class:"error-content"},gt=de({__name:"SiliconFlowView",setup(j){const{models:m,config:v,usage:p,loading:y,testResult:i,fetchModels:g,fetchConfig:O,updateConfig:T,testAPIConnection:B,fetchUsage:F,formatPrice:M,formatLatency:$,getProviderColor:L}=je(),w=C(!1),I=C(!1),s=J({api_key:"",base_url:"https://api.siliconflow.cn/v1",default_model:"Qwen/Qwen2.5-72B-Instruct",max_tokens:"4096",temperature:"0.7",stream:"true"}),r=J({api_key:"",base_url:"https://api.siliconflow.cn/v1",model:"Qwen/Qwen2.5-72B-Instruct",message:"你好，请介绍一下你自己。",max_tokens:100,temperature:.7}),P=()=>{Object.assign(s,v.value),w.value=!0},Y=()=>{r.api_key=v.value.api_key,r.base_url=v.value.base_url,r.model=v.value.default_model,I.value=!0},N=async h=>{try{await T({default_model:h}),V.success("默认模型已更新")}catch{V.error("更新模型失败")}},Z=async()=>{try{await T(s),w.value=!1,V.success("配置保存成功")}catch{V.error("配置保存失败")}},G=async()=>{var h;try{await B(r),(h=i.value)!=null&&h.success&&V.success("API连接测试成功")}catch{}},z=async()=>{try{await Promise.all([g(),O(),F()]),V.success("数据刷新成功")}catch{V.error("数据刷新失败")}};return ue(()=>{z()}),(h,e)=>{const x=ce,k=me,W=R("CloudOffline"),D=we,X=R("Cpu"),ee=ke,te=be,A=xe,f=Ie,Q=Ae,q=Pe,le=Ee,se=Se,oe=Te,K=Ce,H=ve,ae=Me,ne=ge;return d(),u("div",Oe,[e[38]||(e[38]=l("div",{class:"page-header"},[l("h1",{class:"page-title"},"硅基流动模型管理"),l("p",{class:"page-subtitle"},"管理硅基流动AI模型和API配置")],-1)),l("div",Be,[n(p)?(d(),u("div",Fe,[o(x,{class:"stat-card",shadow:"hover"},{default:a(()=>[l("div",$e,[l("div",Le,c(n(p).total_requests.toLocaleString()),1),e[16]||(e[16]=l("div",{class:"stat-label"},"总请求数",-1))])]),_:1}),o(x,{class:"stat-card",shadow:"hover"},{default:a(()=>[l("div",Ne,[l("div",ze,c(n(p).total_tokens.toLocaleString()),1),e[17]||(e[17]=l("div",{class:"stat-label"},"总Token数",-1))])]),_:1}),o(x,{class:"stat-card",shadow:"hover"},{default:a(()=>[l("div",De,[l("div",Qe,"¥"+c(n(p).total_cost.toFixed(2)),1),e[18]||(e[18]=l("div",{class:"stat-label"},"总费用",-1))])]),_:1}),o(x,{class:"stat-card",shadow:"hover"},{default:a(()=>[l("div",qe,[l("div",Ke,c(n(p).today_requests),1),e[19]||(e[19]=l("div",{class:"stat-label"},"今日请求",-1))])]),_:1})])):b("",!0),l("div",He,[o(k,{type:"primary",onClick:P,icon:n(pe)},{default:a(()=>[...e[20]||(e[20]=[_(" API配置 ",-1)])]),_:1},8,["icon"]),o(k,{type:"success",onClick:Y,icon:n(fe)},{default:a(()=>[...e[21]||(e[21]=[_(" 连接测试 ",-1)])]),_:1},8,["icon"]),o(k,{onClick:z,icon:n(_e)},{default:a(()=>[...e[22]||(e[22]=[_(" 刷新数据 ",-1)])]),_:1},8,["icon"])]),o(x,{shadow:"hover"},{header:a(()=>[...e[23]||(e[23]=[l("div",{class:"card-header"},[l("h3",null,"可用模型"),l("p",null,"硅基流动支持的AI模型列表")],-1)])]),default:a(()=>[n(y)?ye((d(),u("div",Je,[...e[24]||(e[24]=[l("p",null,"加载中...",-1)])])),[[ne,n(y)]]):n(m).length===0?(d(),u("div",Re,[o(D,{size:"48"},{default:a(()=>[o(W)]),_:1}),e[25]||(e[25]=l("p",null,"暂无可用模型",-1))])):(d(),u("div",Ye,[(d(!0),u(E,null,S(n(m),t=>(d(),u("div",{key:t.id,class:he(["model-card",{selected:n(v).default_model===t.id}]),onClick:re=>N(t.id)},[l("div",Ge,[l("div",We,[o(D,null,{default:a(()=>[o(X)]),_:1}),l("div",null,[l("h3",null,c(t.name),1),o(ee,{type:n(L)(t.provider),size:"small"},{default:a(()=>[_(c(t.provider),1)]),_:2},1032,["type"])])]),o(te,{"model-value":n(v).default_model===t.id,onChange:re=>N(t.id)},null,8,["model-value","onChange"])]),l("p",Xe,c(t.description),1),l("div",et,[l("div",tt,[e[26]||(e[26]=l("span",{class:"label"},"最大Token:",-1)),l("span",lt,c(t.max_tokens.toLocaleString()),1)]),t.pricing?(d(),u("div",st,[e[27]||(e[27]=l("span",{class:"label"},"输入价格:",-1)),l("span",ot,c(n(M)(t.pricing.input)),1)])):b("",!0),t.pricing?(d(),u("div",at,[e[28]||(e[28]=l("span",{class:"label"},"输出价格:",-1)),l("span",nt,c(n(M)(t.pricing.output)),1)])):b("",!0)])],10,Ze))),128))]))]),_:1}),n(p)&&n(p).popular_models.length>0?(d(),U(x,{key:1,shadow:"hover"},{header:a(()=>[...e[29]||(e[29]=[l("div",{class:"card-header"},[l("h3",null,"热门模型"),l("p",null,"使用频率统计")],-1)])]),default:a(()=>[l("div",rt,[(d(!0),u(E,null,S(n(p).popular_models,t=>(d(),u("div",{key:t.model,class:"popular-model-item"},[l("div",it,c(t.model),1),l("div",dt,[l("div",{class:"usage-fill",style:Ve({width:t.percentage+"%"})},null,4)]),l("div",ut,[l("span",null,c(t.requests)+" 次",1),l("span",null,c(t.percentage)+"%",1)])]))),128))])]),_:1})):b("",!0)]),o(H,{modelValue:w.value,"onUpdate:modelValue":e[7]||(e[7]=t=>w.value=t),title:"API配置",width:"500px",onClose:e[8]||(e[8]=t=>w.value=!1)},{footer:a(()=>[o(k,{onClick:e[6]||(e[6]=t=>w.value=!1)},{default:a(()=>[...e[30]||(e[30]=[_("取消",-1)])]),_:1}),o(k,{type:"primary",onClick:Z,loading:n(y)},{default:a(()=>[...e[31]||(e[31]=[_(" 保存配置 ",-1)])]),_:1},8,["loading"])]),default:a(()=>[o(K,{model:s,"label-width":"100px"},{default:a(()=>[o(f,{label:"API Key"},{default:a(()=>[o(A,{modelValue:s.api_key,"onUpdate:modelValue":e[0]||(e[0]=t=>s.api_key=t),type:"password",placeholder:"请输入硅基流动API Key","show-password":""},null,8,["modelValue"])]),_:1}),o(f,{label:"API地址"},{default:a(()=>[o(A,{modelValue:s.base_url,"onUpdate:modelValue":e[1]||(e[1]=t=>s.base_url=t),placeholder:"https://api.siliconflow.cn/v1"},null,8,["modelValue"])]),_:1}),o(f,{label:"默认模型"},{default:a(()=>[o(q,{modelValue:s.default_model,"onUpdate:modelValue":e[2]||(e[2]=t=>s.default_model=t),placeholder:"请选择默认模型"},{default:a(()=>[(d(!0),u(E,null,S(n(m),t=>(d(),U(Q,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(f,{label:"最大Token数"},{default:a(()=>[o(le,{modelValue:s.max_tokens,"onUpdate:modelValue":e[3]||(e[3]=t=>s.max_tokens=t),placeholder:"4096",min:1,max:32e3},null,8,["modelValue"])]),_:1}),o(f,{label:"温度参数"},{default:a(()=>[o(se,{modelValue:s.temperature,"onUpdate:modelValue":e[4]||(e[4]=t=>s.temperature=t),min:0,max:2,step:.1,"show-input":""},null,8,["modelValue"])]),_:1}),o(f,{label:"流式输出"},{default:a(()=>[o(oe,{modelValue:s.stream,"onUpdate:modelValue":e[5]||(e[5]=t=>s.stream=t)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),o(H,{modelValue:I.value,"onUpdate:modelValue":e[14]||(e[14]=t=>I.value=t),title:"API连接测试",width:"600px",onClose:e[15]||(e[15]=t=>I.value=!1)},{footer:a(()=>[o(k,{onClick:e[13]||(e[13]=t=>I.value=!1)},{default:a(()=>[...e[32]||(e[32]=[_("取消",-1)])]),_:1}),o(k,{type:"primary",onClick:G,loading:n(y)},{default:a(()=>[...e[33]||(e[33]=[_(" 开始测试 ",-1)])]),_:1},8,["loading"])]),default:a(()=>[o(K,{model:r,"label-width":"100px"},{default:a(()=>[o(f,{label:"API Key"},{default:a(()=>[o(A,{modelValue:r.api_key,"onUpdate:modelValue":e[9]||(e[9]=t=>r.api_key=t),type:"password",placeholder:"请输入API Key","show-password":""},null,8,["modelValue"])]),_:1}),o(f,{label:"API地址"},{default:a(()=>[o(A,{modelValue:r.base_url,"onUpdate:modelValue":e[10]||(e[10]=t=>r.base_url=t),placeholder:"https://api.siliconflow.cn/v1"},null,8,["modelValue"])]),_:1}),o(f,{label:"测试模型"},{default:a(()=>[o(q,{modelValue:r.model,"onUpdate:modelValue":e[11]||(e[11]=t=>r.model=t),placeholder:"请选择模型"},{default:a(()=>[(d(!0),u(E,null,S(n(m),t=>(d(),U(Q,{key:t.id,label:t.name,value:t.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(f,{label:"测试消息"},{default:a(()=>[o(A,{modelValue:r.message,"onUpdate:modelValue":e[12]||(e[12]=t=>r.message=t),type:"textarea",placeholder:"你好，请介绍一下你自己。",rows:3},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]),n(i)?(d(),u("div",ct,[o(ae,{type:n(i).success?"success":"error",title:n(i).success?"测试成功":"测试失败","show-icon":""},{default:a(()=>[n(i).success?(d(),u("div",pt,[l("div",mt,[n(i).latency?(d(),u("div",ft,[e[34]||(e[34]=l("strong",null,"响应时间:",-1)),_(" "+c(n($)(n(i).latency)),1)])):b("",!0),n(i).tokens_used?(d(),u("div",_t,[e[35]||(e[35]=l("strong",null,"使用Token:",-1)),_(" "+c(n(i).tokens_used),1)])):b("",!0)]),l("div",vt,[e[36]||(e[36]=l("strong",null,"模型响应:",-1)),l("p",null,c(n(i).response),1)])])):(d(),u("div",yt,[e[37]||(e[37]=l("strong",null,"错误信息:",-1)),l("p",null,c(n(i).error),1)]))]),_:1},8,["type","title"])])):b("",!0)]),_:1},8,["modelValue"])])}}}),ht=Ue(gt,[["__scopeId","data-v-de553765"]]);export{ht as default};
